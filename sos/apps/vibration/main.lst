   1               		.file	"main.c"
   2               		.arch atmega128
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  12               		.text
  13               	.Ltext0:
 304               	.global	sos_main
 306               	sos_main:
   1:/Users/Administrator/sos-2x/kernel/main.c **** /* -*- Mode: C; tab-width:4 -*- */
   2:/Users/Administrator/sos-2x/kernel/main.c **** /* ex: set ts=4 shiftwidth=4 softtabstop=4 cindent: */
   3:/Users/Administrator/sos-2x/kernel/main.c **** /*
   4:/Users/Administrator/sos-2x/kernel/main.c ****  * Copyright (c) 2003 The Regents of the University of California.
   5:/Users/Administrator/sos-2x/kernel/main.c ****  * All rights reserved.
   6:/Users/Administrator/sos-2x/kernel/main.c ****  *
   7:/Users/Administrator/sos-2x/kernel/main.c ****  * Redistribution and use in source and binary forms, with or without
   8:/Users/Administrator/sos-2x/kernel/main.c ****  * modification, are permitted provided that the following conditions
   9:/Users/Administrator/sos-2x/kernel/main.c ****  * are met:
  10:/Users/Administrator/sos-2x/kernel/main.c ****  * 1. Redistributions of source code must retain the above copyright
  11:/Users/Administrator/sos-2x/kernel/main.c ****  *    notice, this list of conditions and the following disclaimer.
  12:/Users/Administrator/sos-2x/kernel/main.c ****  * 2. Redistributions in binary form must reproduce the above
  13:/Users/Administrator/sos-2x/kernel/main.c ****  *    copyright notice, this list of conditions and the following
  14:/Users/Administrator/sos-2x/kernel/main.c ****  *    disclaimer in the documentation and/or other materials provided
  15:/Users/Administrator/sos-2x/kernel/main.c ****  *    with the distribution.
  16:/Users/Administrator/sos-2x/kernel/main.c ****  * 3. All advertising materials mentioning features or use of this
  17:/Users/Administrator/sos-2x/kernel/main.c ****  *    software must display the following acknowledgement:
  18:/Users/Administrator/sos-2x/kernel/main.c ****  *       This product includes software developed by Networked &
  19:/Users/Administrator/sos-2x/kernel/main.c ****  *       Embedded Systems Lab at UCLA
  20:/Users/Administrator/sos-2x/kernel/main.c ****  * 4. Neither the name of the University nor that of the Laboratory
  21:/Users/Administrator/sos-2x/kernel/main.c ****  *    may be used to endorse or promote products derived from this
  22:/Users/Administrator/sos-2x/kernel/main.c ****  *    software without specific prior written permission.
  23:/Users/Administrator/sos-2x/kernel/main.c ****  *
  24:/Users/Administrator/sos-2x/kernel/main.c ****  * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS''
  25:/Users/Administrator/sos-2x/kernel/main.c ****  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
  26:/Users/Administrator/sos-2x/kernel/main.c ****  * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
  27:/Users/Administrator/sos-2x/kernel/main.c ****  * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS
  28:/Users/Administrator/sos-2x/kernel/main.c ****  * OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  29:/Users/Administrator/sos-2x/kernel/main.c ****  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
  30:/Users/Administrator/sos-2x/kernel/main.c ****  * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
  31:/Users/Administrator/sos-2x/kernel/main.c ****  * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  32:/Users/Administrator/sos-2x/kernel/main.c ****  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  33:/Users/Administrator/sos-2x/kernel/main.c ****  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
  34:/Users/Administrator/sos-2x/kernel/main.c ****  * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
  35:/Users/Administrator/sos-2x/kernel/main.c ****  * SUCH DAMAGE.
  36:/Users/Administrator/sos-2x/kernel/main.c ****  *
  37:/Users/Administrator/sos-2x/kernel/main.c ****  */
  38:/Users/Administrator/sos-2x/kernel/main.c **** /**
  39:/Users/Administrator/sos-2x/kernel/main.c ****  * @brief  SOS booting sequence
  40:/Users/Administrator/sos-2x/kernel/main.c ****  * @author Simon Han (simonhan@ee.ucla.edu)
  41:/Users/Administrator/sos-2x/kernel/main.c ****  *
  42:/Users/Administrator/sos-2x/kernel/main.c ****  * Platform dependent booting sequence should go to 
  43:/Users/Administrator/sos-2x/kernel/main.c ****  * hardware.c or hardware_*.c of particular platform
  44:/Users/Administrator/sos-2x/kernel/main.c ****  */
  45:/Users/Administrator/sos-2x/kernel/main.c **** #include <hardware.h>
  46:/Users/Administrator/sos-2x/kernel/main.c **** #include <sos_sched.h>
  47:/Users/Administrator/sos-2x/kernel/main.c **** #include <message_queue.h>
  48:/Users/Administrator/sos-2x/kernel/main.c **** #include <sos_module_fetcher.h>
  49:/Users/Administrator/sos-2x/kernel/main.c **** #include <random.h>
  50:/Users/Administrator/sos-2x/kernel/main.c **** #include <sensor.h>
  51:/Users/Administrator/sos-2x/kernel/main.c **** 
  52:/Users/Administrator/sos-2x/kernel/main.c **** #ifdef NEW_SENSING_API
  53:/Users/Administrator/sos-2x/kernel/main.c **** #include <sensor_kernel.h>
  54:/Users/Administrator/sos-2x/kernel/main.c **** #endif
  55:/Users/Administrator/sos-2x/kernel/main.c **** 
  56:/Users/Administrator/sos-2x/kernel/main.c **** #include <malloc.h>
  57:/Users/Administrator/sos-2x/kernel/main.c **** #include <monitor.h>
  58:/Users/Administrator/sos-2x/kernel/main.c **** #include <fntable.h>
  59:/Users/Administrator/sos-2x/kernel/main.c **** #include <sos_info.h>
  60:/Users/Administrator/sos-2x/kernel/main.c **** #include <sos_shm.h>
  61:/Users/Administrator/sos-2x/kernel/main.c **** #include <message.h>
  62:/Users/Administrator/sos-2x/kernel/main.c **** #ifdef SOS_USE_PREEMPTION
  63:/Users/Administrator/sos-2x/kernel/main.c **** #include <priority.h>
  64:/Users/Administrator/sos-2x/kernel/main.c **** #endif
  65:/Users/Administrator/sos-2x/kernel/main.c **** //#include <version_sync.h>
  66:/Users/Administrator/sos-2x/kernel/main.c **** 
  67:/Users/Administrator/sos-2x/kernel/main.c **** #ifdef SOS_SFI
  68:/Users/Administrator/sos-2x/kernel/main.c **** #include <sfi_jumptable.h>
  69:/Users/Administrator/sos-2x/kernel/main.c **** #endif
  70:/Users/Administrator/sos-2x/kernel/main.c **** 
  71:/Users/Administrator/sos-2x/kernel/main.c **** 
  72:/Users/Administrator/sos-2x/kernel/main.c **** /**
  73:/Users/Administrator/sos-2x/kernel/main.c ****  * @brief application start
  74:/Users/Administrator/sos-2x/kernel/main.c ****  * 
  75:/Users/Administrator/sos-2x/kernel/main.c ****  * Application will define this function
  76:/Users/Administrator/sos-2x/kernel/main.c ****  */
  77:/Users/Administrator/sos-2x/kernel/main.c **** extern void sos_start();
  78:/Users/Administrator/sos-2x/kernel/main.c **** 
  79:/Users/Administrator/sos-2x/kernel/main.c **** 
  80:/Users/Administrator/sos-2x/kernel/main.c **** /**
  81:/Users/Administrator/sos-2x/kernel/main.c ****  * @file     SOS core loop
  82:/Users/Administrator/sos-2x/kernel/main.c ****  * @brief    main function 
  83:/Users/Administrator/sos-2x/kernel/main.c ****  * @author   Simon Han (simonhan@ee.ucla.edu)
  84:/Users/Administrator/sos-2x/kernel/main.c ****  */
  85:/Users/Administrator/sos-2x/kernel/main.c **** 
  86:/Users/Administrator/sos-2x/kernel/main.c **** /** 
  87:/Users/Administrator/sos-2x/kernel/main.c ****  * @brief Core event loop
  88:/Users/Administrator/sos-2x/kernel/main.c ****  */
  89:/Users/Administrator/sos-2x/kernel/main.c **** int sos_main(uint8_t cond){
 308               	.LM1:
 309               	/* prologue: frame size=0 */
 310 0000 1F93      		push r17
 311               	/* prologue end (size=1) */
 312 0002 182F      		mov r17,r24
  90:/Users/Administrator/sos-2x/kernel/main.c **** 
  91:/Users/Administrator/sos-2x/kernel/main.c **** 	//! disable interrupt
  92:/Users/Administrator/sos-2x/kernel/main.c **** 	DISABLE_GLOBAL_INTERRUPTS();
 314               	.LM2:
 315               	/* #APP */
 316 0004 F894      		cli
  93:/Users/Administrator/sos-2x/kernel/main.c **** 	
  94:/Users/Administrator/sos-2x/kernel/main.c **** 	//! Initialize the ID
  95:/Users/Administrator/sos-2x/kernel/main.c **** 	id_init();
 318               	.LM3:
 319               	/* #NOAPP */
 320 0006 0E94 0000 		call id_init
  96:/Users/Administrator/sos-2x/kernel/main.c **** 
  97:/Users/Administrator/sos-2x/kernel/main.c ****     //! initialize memory manager
  98:/Users/Administrator/sos-2x/kernel/main.c ****     mem_init();
 322               	.LM4:
 323 000a 0E94 0000 		call mem_init
  99:/Users/Administrator/sos-2x/kernel/main.c **** 
 100:/Users/Administrator/sos-2x/kernel/main.c **** 	shm_init();
 325               	.LM5:
 326 000e 0E94 0000 		call shm_init
 101:/Users/Administrator/sos-2x/kernel/main.c **** 
 102:/Users/Administrator/sos-2x/kernel/main.c **** 	//! initialize message pool
 103:/Users/Administrator/sos-2x/kernel/main.c **** 	msg_queue_init();
 328               	.LM6:
 329 0012 0E94 0000 		call msg_queue_init
 104:/Users/Administrator/sos-2x/kernel/main.c **** 
 105:/Users/Administrator/sos-2x/kernel/main.c **** 	//! initialize random number generator
 106:/Users/Administrator/sos-2x/kernel/main.c **** 	random_init();
 331               	.LM7:
 332 0016 0E94 0000 		call random_init
 107:/Users/Administrator/sos-2x/kernel/main.c **** 
 108:/Users/Administrator/sos-2x/kernel/main.c ****     //! initialize scheduler
 109:/Users/Administrator/sos-2x/kernel/main.c ****     sched_init(cond);
 334               	.LM8:
 335 001a 812F      		mov r24,r17
 336 001c 0E94 0000 		call sched_init
 110:/Users/Administrator/sos-2x/kernel/main.c **** 
 111:/Users/Administrator/sos-2x/kernel/main.c **** 	//! initialize sensor manager
 112:/Users/Administrator/sos-2x/kernel/main.c **** #ifdef NEW_SENSING_API
 113:/Users/Administrator/sos-2x/kernel/main.c **** 	sensor_system_init();
 114:/Users/Administrator/sos-2x/kernel/main.c **** #else
 115:/Users/Administrator/sos-2x/kernel/main.c **** 	sensor_init();
 338               	.LM9:
 339 0020 0E94 0000 		call sensor_init
 116:/Users/Administrator/sos-2x/kernel/main.c **** #endif
 117:/Users/Administrator/sos-2x/kernel/main.c **** 
 118:/Users/Administrator/sos-2x/kernel/main.c **** 	//! initialize the Function Table
 119:/Users/Administrator/sos-2x/kernel/main.c **** 	fntable_init();
 341               	.LM10:
 342 0024 0E94 0000 		call fntable_init
 120:/Users/Administrator/sos-2x/kernel/main.c **** 
 121:/Users/Administrator/sos-2x/kernel/main.c **** 	//! Initialize the monitor
 122:/Users/Administrator/sos-2x/kernel/main.c **** 	monitor_init();
 344               	.LM11:
 345 0028 0E94 0000 		call monitor_init
 123:/Users/Administrator/sos-2x/kernel/main.c **** 
 124:/Users/Administrator/sos-2x/kernel/main.c ****     //! initialize hardware
 125:/Users/Administrator/sos-2x/kernel/main.c ****     hardware_init();
 347               	.LM12:
 348 002c 0E94 0000 		call hardware_init
 126:/Users/Administrator/sos-2x/kernel/main.c **** 
 127:/Users/Administrator/sos-2x/kernel/main.c **** 	codemem_init();
 350               	.LM13:
 351 0030 0E94 0000 		call codemem_init
 128:/Users/Administrator/sos-2x/kernel/main.c **** 
 129:/Users/Administrator/sos-2x/kernel/main.c **** 	routing_init();
 353               	.LM14:
 354 0034 0E94 0000 		call routing_init
 130:/Users/Administrator/sos-2x/kernel/main.c **** 
 131:/Users/Administrator/sos-2x/kernel/main.c **** 	//! starting memory module
 132:/Users/Administrator/sos-2x/kernel/main.c **** 	mem_start();
 356               	.LM15:
 357 0038 0E94 0000 		call mem_start
 133:/Users/Administrator/sos-2x/kernel/main.c **** 
 134:/Users/Administrator/sos-2x/kernel/main.c **** #ifdef SOS_SFI
 135:/Users/Administrator/sos-2x/kernel/main.c **** 	//! Initialize SFI
 136:/Users/Administrator/sos-2x/kernel/main.c **** 	sfi_modtable_init();
 137:/Users/Administrator/sos-2x/kernel/main.c **** #endif
 138:/Users/Administrator/sos-2x/kernel/main.c **** 
 139:/Users/Administrator/sos-2x/kernel/main.c **** 	//! Initialize the code fetcher
 140:/Users/Administrator/sos-2x/kernel/main.c **** 	fetcher_init();
 359               	.LM16:
 360 003c 0E94 0000 		call fetcher_init
 141:/Users/Administrator/sos-2x/kernel/main.c **** 
 142:/Users/Administrator/sos-2x/kernel/main.c ****     //! enable interrupt
 143:/Users/Administrator/sos-2x/kernel/main.c **** 	ENABLE_GLOBAL_INTERRUPTS();
 362               	.LM17:
 363               	/* #APP */
 364 0040 7894      		sei
 144:/Users/Administrator/sos-2x/kernel/main.c **** 
 145:/Users/Administrator/sos-2x/kernel/main.c **** #ifdef SOS_USE_PREEMPTION
 146:/Users/Administrator/sos-2x/kernel/main.c **** 	// Enable preemption
 147:/Users/Administrator/sos-2x/kernel/main.c **** 	MAIN_ENABLE_PREEMPTION();
 148:/Users/Administrator/sos-2x/kernel/main.c **** #endif
 149:/Users/Administrator/sos-2x/kernel/main.c **** 	DEBUG("SOS booted\n");
 150:/Users/Administrator/sos-2x/kernel/main.c ****     //! start application
 151:/Users/Administrator/sos-2x/kernel/main.c ****     sos_start();
 366               	.LM18:
 367               	/* #NOAPP */
 368 0042 0E94 0000 		call sos_start
 152:/Users/Administrator/sos-2x/kernel/main.c **** 
 153:/Users/Administrator/sos-2x/kernel/main.c ****     //! enter main sched loop
 154:/Users/Administrator/sos-2x/kernel/main.c ****     //! should never return from this call
 155:/Users/Administrator/sos-2x/kernel/main.c **** 	sched();
 370               	.LM19:
 371 0046 0E94 0000 		call sched
 156:/Users/Administrator/sos-2x/kernel/main.c ****     return 0;
 157:/Users/Administrator/sos-2x/kernel/main.c **** }
 373               	.LM20:
 374 004a 80E0      		ldi r24,lo8(0)
 375 004c 90E0      		ldi r25,hi8(0)
 376               	/* epilogue: frame size=0 */
 377 004e 1F91      		pop r17
 378 0050 0895      		ret
 379               	/* epilogue end (size=2) */
 380               	/* function sos_main size 43 (40) */
 382               	.Lscope0:
 384               		.text
 386               	Letext:
 387               	/* File "/Users/Administrator/sos-2x/kernel/main.c": code   43 = 0x002b (  40), prologues   1, epil
DEFINED SYMBOLS
                            *ABS*:00000000 main.c
                            *ABS*:0000003f __SREG__
                            *ABS*:0000003e __SP_H__
                            *ABS*:0000003d __SP_L__
                            *ABS*:00000000 __tmp_reg__
                            *ABS*:00000001 __zero_reg__
/var/tmp//ccdnZQ6U.s:306    .text:00000000 sos_main
/var/tmp//ccdnZQ6U.s:386    .text:00000052 Letext

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
id_init
mem_init
shm_init
msg_queue_init
random_init
sched_init
sensor_init
fntable_init
monitor_init
hardware_init
codemem_init
routing_init
mem_start
fetcher_init
sos_start
sched
