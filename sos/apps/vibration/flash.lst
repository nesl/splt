GAS LISTING /var/tmp//ccJldAjN.s 			page 1


   1               	# 1 "/Users/Administrator/sos-2x/processor/avr/flash.S"
   2               	# 1 "<built-in>"
   1               	; -*- Mode: C; tab-width:4 -*-
   0               	
   0               	
   2               	; ex: set ts=4:
   3               	; Copyright (C) 2002 by egnite Software GmbH. All rights reserved.
   4               	;
   5               	; Redistribution and use in source and binary forms, with or without
   6               	; modification, are permitted provided that the following conditions
   7               	; are met:
   8               	;
   9               	; 1. Redistributions of source code must retain the above copyright
  10               	;    notice, this list of conditions and the following disclaimer.
  11               	; 2. Redistributions in binary form must reproduce the above copyright
  12               	;    notice, this list of conditions and the following disclaimer in the
  13               	;    documentation and/or other materials provided with the distribution.
  14               	; 3. All advertising materials mentioning features or use of this
  15               	;    software must display the following acknowledgement:
  16               	;
  17               	;    This product includes software developed by egnite Software GmbH
  18               	;    and its contributors.
  19               	;
  20               	; THIS SOFTWARE IS PROVIDED BY EGNITE SOFTWARE GMBH AND CONTRIBUTORS
  21               	; ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
  22               	; LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
  23               	; FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL EGNITE
  24               	; SOFTWARE GMBH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
  25               	; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
  26               	; BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
  27               	; OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
  28               	; AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  29               	; OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF
  30               	; THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
  31               	; SUCH DAMAGE.
  32               	;
  33               	; For additional information see http://www.ethernut.de/
  34               	;
  35               	;	
  36               	; This file has its orgin in following sources:
  37               	;
  38               	;  - Jaroslaw Karwik's RS232 boot loader
  39               	;  - Atmel's AVR109 application note "Self programming" ( www.atmel.com )
  40               	;  - Andy's Hutchinson modifications/optimizations of the original Atmel's code
  41               	;  - Bryce Denney's patches  ( bryce@tlw.com)
  42               	;
  43               	
  44               	;
  45               	;
  46               	
  47               	#define RAMPZ   0x3B
  48               	#define SPMCR   0x68
  49               	
  50               			.section .sos_bls
  51               	        .global SpmBufferFill
  52               	        .global SpmCommand
  53               	
GAS LISTING /var/tmp//ccJldAjN.s 			page 2


  54               	SpmCommand:
  55:/Users/Administrator/sos-2x/processor/avr/flash.S ****         movw    r30, r24        ; First argument is page address
  56:/Users/Administrator/sos-2x/processor/avr/flash.S ****         rjmp	DoSpm
  57               	
  58               	SpmBufferFill:
  59:/Users/Administrator/sos-2x/processor/avr/flash.S ****         movw    r30, r24        ; First argument is page address  
  60:/Users/Administrator/sos-2x/processor/avr/flash.S ****         movw    r0, r22         ; Second argument is data pointer 
  61:/Users/Administrator/sos-2x/processor/avr/flash.S ****         ldi     r22, 1          ; SPMEN bit
  62               	
  63               	DoSpm:
  64:/Users/Administrator/sos-2x/processor/avr/flash.S ****         sts     SPMCR, r22      ; Store function in SPMCR
  65:/Users/Administrator/sos-2x/processor/avr/flash.S ****         spm                     ; store program memory
  66               	
  67               	WaitSpm:
  68:/Users/Administrator/sos-2x/processor/avr/flash.S ****         lds     r22, SPMCR      ; Loop until SPMEN in SPMCR is cleared
  69:/Users/Administrator/sos-2x/processor/avr/flash.S ****         sbrc    r22, 0
  70:/Users/Administrator/sos-2x/processor/avr/flash.S ****         rjmp    WaitSpm
  71               	
  72:/Users/Administrator/sos-2x/processor/avr/flash.S **** 	clr     r1	        ; Compiler depends on R1 set to zero.
  73:/Users/Administrator/sos-2x/processor/avr/flash.S ****         ret
GAS LISTING /var/tmp//ccJldAjN.s 			page 3


DEFINED SYMBOLS
                            *ABS*:00000000 /Users/Administrator/sos-2x/processor/avr/flash.S
                            *ABS*:00000000 <command line>
                            *ABS*:00000000 <built-in>
                            *ABS*:00000000 /Users/Administrator/sos-2x/processor/avr/flash.S
/Users/Administrator/sos-2x/processor/avr/flash.S:58     .sos_bls:00000004 SpmBufferFill
/Users/Administrator/sos-2x/processor/avr/flash.S:54     .sos_bls:00000000 SpmCommand
/Users/Administrator/sos-2x/processor/avr/flash.S:63     .sos_bls:0000000a DoSpm
/Users/Administrator/sos-2x/processor/avr/flash.S:67     .sos_bls:00000010 WaitSpm

NO UNDEFINED SYMBOLS
